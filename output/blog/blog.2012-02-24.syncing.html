<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Aaron O'Leary - blog</title>
    <meta name="description" content="a poole site" />
    <meta name="keywords" content="poole" />
    <link rel="stylesheet" type="text/css" href="/home/eeaol/web/output/markdown.css" />
    <link rel="stylesheet" type="text/css" href="/home/eeaol/web/output/pygment.css" />
</head>
<body>
    <div id="box">
    <div id="header">
         <h1>blog</h1>
    </div>
    <div id="menu">
    <span class=""><a href="/home/eeaol/web/output/index.html">home</a></span>
<span class=""><a href="/home/eeaol/web/output/code.html">code</a></span>
<span class="current"><a href="/home/eeaol/web/output/blog.html">blog</a></span>
<span class=""><a href="/home/eeaol/web/output/meta.html">meta</a></span>
    </div>
    <div id="content"><p>I have two main workspaces: my university account and my laptop, both
linux environments (CentOS 5.1 and Debian Squeeze). Files stored on my
university account are backed up on a daily basis and I have access to
a number of fast machines for data processing - this makes working on
my uni account, either locally in my office or remotely through ssh,
the preferred way of doing things.</p>
<p>However, I am frequently in a situation where I don't have network
access, e.g. field work, travelling, low battery on my laptop. I often
write a lot / download and read a lot of papers in these situations
(probably exactly because I can't get on a network) and end up with
a lot of stuff I need to copy back into my uni account.</p>
<p>There are two distinct cases here:</p>
<div class="codehilite"><pre><span class="mi">1</span><span class="o">.</span> <span class="n">Distinct</span> <span class="k">new</span> <span class="n">files</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">pdfs</span><span class="p">)</span>
<span class="mi">2</span><span class="o">.</span> <span class="n">Modified</span> <span class="n">codebase</span> <span class="o">/</span> <span class="n">writing</span><span class="o">.</span>
</pre></div>


<p>I use git for version control, which I'll come to later. First I'll
deal with synchronising files using <strong>rsync</strong>.</p>
<h3>Rsync</h3>
<p>Local folder to remote folder:</p>
<div class="codehilite"><pre><span class="n">rsync</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">e</span> <span class="s">&quot;ssh -l eeaol&quot;</span> <span class="o">--</span><span class="nb">delete</span> <span class="o">~</span><span class="sr">/testy/</span> <span class="k">my</span><span class="o">-</span><span class="n">ssh</span><span class="o">-</span><span class="n">gw</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk:</span><span class="o">~/</span><span class="n">test2</span>
</pre></div>


<p>sender: ~/testy
destination: eeaol@see-gw-01.leeds.ac.uk:~/test2</p>
<p>-r : recursive
-a : archive mode (preserves file modification times and more).
-v : verbose
-e "ssh -l eeaol" : use ssh with user eeaol
--delete: potentially dangerous. deletes files on the destination side
          not present on the send side.</p>
<p>As a first guess this does something right, but I have to be very careful not
to delete new files that I want.</p>
<p>What I typically have is a folder on each machine full of papers
(as pdf) that have an identical bulk of papers, but some new ones in
both of the directories. To deal with this I have to use rsync twice,
once in both directions:</p>
<div class="codehilite"><pre><span class="n">rsync</span> <span class="o">-</span><span class="n">auzrv</span> <span class="o">-</span><span class="n">e</span> <span class="n">ssh</span> <span class="o">~</span><span class="sr">/home/</span><span class="n">path</span> <span class="n">eeaol</span><span class="nv">@my</span><span class="o">-</span><span class="n">ssh</span><span class="o">-</span><span class="n">gw</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk:</span><span class="o">~</span><span class="sr">/office/</span><span class="n">path</span>
<span class="n">rsync</span> <span class="o">-</span><span class="n">auzrv</span> <span class="o">-</span><span class="n">e</span> <span class="n">ssh</span> <span class="n">eeaol</span><span class="nv">@my</span><span class="o">-</span><span class="n">ssh</span><span class="o">-</span><span class="n">gw</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk:</span><span class="o">~</span><span class="sr">/office/</span><span class="n">path</span> <span class="o">~</span><span class="sr">/home/</span><span class="n">path</span>
</pre></div>


<p>-r : recursive
-a : archive mode (preserves file modification times and more).
-v : verbose
-e ssh : use ssh
-z : use compression
-u : skip files that are newer on the destination </p>
<p>But the problem with this is that it copies all of the files over even
when the two directories are identical!</p>
<p>TODO: more content here</p>
<h3>Git</h3>
<p>I have accounts with github.com and bitbucket.org. I use github for
coding projects that I use in my research and private repositories on
bitbucket for my notes and more experimental coding.</p>
<p>The new user guide at Github is excellent, whereas BitBucket seems to
assume some prior knowledge. One problem that I had was that ssh would
not work from my local (office) machine. A workaround for this is to
use a proxy; in <code>~/.ssh/config</code> put</p>
<div class="codehilite"><pre><span class="n">Host</span> <span class="n">github</span><span class="o">.</span><span class="n">com</span>
<span class="n">ProxyCommand</span> <span class="sr">/usr/</span><span class="nb">local</span><span class="sr">/bin/co</span><span class="n">rkscrew</span> <span class="n">see</span><span class="o">-</span><span class="n">gw</span><span class="o">-</span><span class="mo">01</span><span class="o">.</span><span class="n">leeds</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk</span> <span class="mi">8000</span> <span class="nv">%h</span> <span class="nv">%p</span>
<span class="n">Host</span> <span class="n">bitbucket</span><span class="o">.</span><span class="n">org</span>
<span class="n">ProxyCommand</span> <span class="sr">/usr/</span><span class="nb">local</span><span class="sr">/bin/co</span><span class="n">rkscrew</span> <span class="n">see</span><span class="o">-</span><span class="n">gw</span><span class="o">-</span><span class="mo">01</span><span class="o">.</span><span class="n">leeds</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk</span> <span class="mi">8000</span> <span class="nv">%h</span> <span class="nv">%p</span>
</pre></div>


<p>and ssh works for these sites. ssh can be tested by</p>
<div class="codehilite"><pre><span class="n">ssh</span> <span class="n">git</span><span class="nv">@github</span><span class="o">.</span><span class="n">com</span>
<span class="n">ssh</span> <span class="n">git</span><span class="nv">@bitbucket</span><span class="o">.</span><span class="n">org</span>
</pre></div>


<p>which both return something along the lines of shell access not allowed.</p>
<h3>Usage</h3>
<p>If I'm working on a git managed project in a local repo and I want to
push the changes to one of my web repos, I need to first define where
to push to</p>
<div class="codehilite"><pre><span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">github</span> <span class="n">git</span><span class="nv">@github</span><span class="o">.</span><span class="n">com:aaren</span><span class="o">/</span><span class="n">projectname</span><span class="o">.</span><span class="n">git</span>
</pre></div>


<p>and create a new repo called projectname on GitHub. Then I just do</p>
<div class="codehilite"><pre><span class="n">git</span> <span class="nb">push</span> <span class="o">-</span><span class="n">u</span> <span class="n">github</span> <span class="n">master</span>
</pre></div>


<p>and the master branch is pushed to GitHub. If I also wanted to have
this project mirrored on BitBucket I can do</p>
<div class="codehilite"><pre><span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">bitbucket</span> <span class="n">git</span><span class="nv">@bitbucket</span><span class="o">.</span><span class="n">org:aaaren</span><span class="o">/</span><span class="n">projectname</span><span class="o">.</span><span class="n">git</span>
<span class="n">git</span> <span class="nb">push</span> <span class="o">-</span><span class="n">u</span> <span class="n">bitbucket</span> <span class="n">master</span>
</pre></div>


<p>If I want to work on my own source code on another machine I do</p>
<div class="codehilite"><pre><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nv">@github</span><span class="o">.</span><span class="n">com:aaren</span><span class="o">/</span><span class="n">projectname</span><span class="o">.</span><span class="n">git</span>
</pre></div>


<p>If I want to clone someone elses repo, for example Steve Losh's <code>t</code>,</p>
<div class="codehilite"><pre><span class="n">git</span> <span class="n">clone</span> <span class="n">http:</span><span class="sr">//gi</span><span class="n">thub</span><span class="o">.</span><span class="n">com</span><span class="sr">/sjl/</span><span class="n">t</span><span class="o">.</span><span class="n">git</span>
</pre></div></div>
    </div>
    <div id="footer"; style="font-size: 6pt">
        Built with <a href="http://bitbucket.org/obensonne/poole">Poole</a>
        &middot;
        Licensed as <a href="http://creativecommons.org/licenses/by-sa/3.0">CC-SA</a>
    </div>
</body>
</html>
