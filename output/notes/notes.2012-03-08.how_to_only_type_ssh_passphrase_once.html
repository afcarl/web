<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Aaron O'Leary - notes</title>
    <meta name="description" content="a poole site" />
    <meta name="keywords" content="poole" />
    <link rel="stylesheet" type="text/css" href="/css/markdown.css" />
    <link rel="stylesheet" type="text/css" href="/css/pygment.css" />
</head>
<body>
    <div id="box">
        <div id="header">
            <h1>notes</h1>
        </div>
        <div id="menu">
        <span class=""><a href="/index.html">home</a></span>
<span class="current"><a href="/notes.html">notes</a></span>
<span class=""><a href="/meta.html">meta</a></span>
<span class=""><a href="/cv.html">cv</a></span>
        </div>
        <div id="content">
            <p>Date: 08/03/2012</p>
<p>Using ssh to shell into remote machines is useful. If you do it 
a lot, typing in the password everytime becomes a bit annoying.
Plus, any scripts that login to remote machines will need the 
password to be supplied to them.</p>
<p>The solution is to add your public key to the list of authorised
keys on the remote machine. Put the contents of ~/.ssh/id_rsa.pub
(on your machine) into ~/.ssh/authorized_keys (on the remote machine).</p>
<p>You can now do ssh remotemachine and not have to enter a password.
However, this isn't especially secure. It means that anyone that
manages to access your keys has access to any of the machines you've
added your public key to. This is very not good.</p>
<p>The solution here is to use a ssh passphrase. Regenerate your ssh keys
with</p>
<pre><code>ssh-keygen -p
</code></pre>
<p>and accept the default locations by hitting return. Enter a passphrase
when prompted. Make it really long. If you already have a passphrase,
this command will let you change it without changing the keys.</p>
<p>Great. Now we're back where we started, having to enter a really long
passphrase every time we want to ssh. This is where ssh-agent comes in.
In a single shell session,</p>
<pre><code>:::bash
eval $(ssh-agent)
ssh-add
</code></pre>
<p>would make you enter your passphrase and then remember it for the rest of
that session. But what about working across multiple sessions?</p>
<p>At work I use both bash and csh on kde. We need to tell bash and csh to 
look for the ssh-agent in a specific place. In bash,</p>
<pre><code>:::bash
export SSH_AUTH_SOCK=/tmp/$USER.agent
</code></pre>
<p>in csh,</p>
<pre><code>:::csh
set SSH_AUTH_SOCK=/tmp/$USER.agent
</code></pre>
<p>Then we need to get a single instance of ssh-agent running on login that
will remember the passphrase for all of my shell sessions. In KDE, that
means autostarting something, so in ~/.kde/Autostart, make a file
called ssh-agent (name doesn't matter) that reads</p>
<pre><code>#!/bin/bash
ssh-agent -a /tmp/$USER.agent
ssh-add
</code></pre>
<p>Now on all subsequent logins we will be prompted for our passphrase
on login and never again!</p>
<p>I use Openbox instead of KDE at home. Autostarting in Openbox is done
by creating a file ~/.config/openbox/autostart containing any commands
you want to run on startup, i.e. including the above.</p>
<p>If you don't use csh or bash or KDE or Openbox, I can't help you.</p>
        </div>
    </div>
</body>
</html>
